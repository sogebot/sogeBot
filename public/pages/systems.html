<ul class="nav nav-tabs">
  <li class="nav-item">
    <span data-lang="systems" class="title text-default"></span>
  </li>
  <li class="nav-item">
    <a class="nav-link active" data-toggle="tab" href="#whispers" data-lang="page-settings.systems.whispers.title"></a>
  </li>
  <li class="nav-item">
    <a class="nav-link" data-toggle="tab" href="#points" data-lang="points" id="points-tab-link"></a>
  </li>
  <li class="nav-item">
    <a class="nav-link" data-toggle="tab" href="#songs" data-lang="songs" id="songs-tab-link"></a>
  </li>
  <li class="nav-item">
    <a class="nav-link" data-toggle="tab" href="#gambling" data-lang="gambling"></a>
  </li>
  <li class="nav-item">
    <a class="nav-link" data-toggle="tab" href="#others" data-lang="page-settings.systems.others.title"></a>
  </li>
</ul>

<div class="tab-content">
  <div role="tabpanel" class="tab-pane active" id="whispers">
    <div class="row settings">
      <div class="col">
        <strong data-lang="page-settings.systems.whispers.toggle.listener"></strong>
      </div>
      <div class="col">
        <input id="disableWhisperListener" type="checkbox" data-toggle="toggle" data-on="Enabled" data-off="Disabled" data-onstyle="success"
          data-offstyle="danger">
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="page-settings.systems.whispers.toggle.settings"></strong>
      </div>
      <div class="col">
        <input id="disableSettingsWhispers" type="checkbox" data-toggle="toggle" data-on="Enabled" data-off="Disabled" data-onstyle="success"
          data-offstyle="danger">
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="page-settings.systems.whispers.toggle.permissions"></strong>
      </div>
      <div class="col">
        <input id="disablePermissionWhispers" type="checkbox" data-toggle="toggle" data-on="Enabled" data-off="Disabled" data-onstyle="success"
          data-offstyle="danger">
      </div>
      <div class="w-100"></div>

      <div class="col systems-cooldown-only">
        <strong data-lang="page-settings.systems.whispers.toggle.cooldowns"></strong>
      </div>
      <div class="col systems-cooldown-only">
        <input id="disableCooldownWhispers" type="checkbox" data-toggle="toggle" data-on="Enabled" data-off="Disabled" data-onstyle="success"
          data-offstyle="danger">
      </div>
    </div>
  </div>

  <div role="tabpanel" class="tab-pane" id="points">
    <div class="row settings">
      <div class="col">
        <strong data-lang="points-name"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="pointsName" onclick="commons.configEditable(this, '')" id="configPointsName"></abbr>
        <div class="input-group" style="display:none;" id="input_pointsName_group">
          <div class="input-group-addon" data-lang="points-single-multi"></div>
          <input id="input_pointsName" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="points-interval"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="pointsInterval" onclick="commons.configEditable(this, 'min')" id="configPointsInterval"></abbr>
        <div class="input-group" style="display:none;" id="input_pointsInterval_group">
          <div class="input-group-addon" data-lang="minutes"></div>
          <input id="input_pointsInterval" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="points-per-interval"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="pointsPerInterval" onclick="commons.configEditable(this, '')" id="configPointsPerInterval"></abbr>
        <div class="input-group" style="display:none;" id="input_pointsPerInterval_group">
          <div class="input-group-addon" data-lang="points"></div>
          <input id="input_pointsPerInterval" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="points-interval-offline"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="pointsIntervalOffline" onclick="commons.configEditable(this, 'min')" id="configPointsIntervalOffline"></abbr>
        <div class="input-group" style="display:none;" id="input_pointsIntervalOffline_group">
          <div class="input-group-addon" data-lang="minutes"></div>
          <input id="input_pointsIntervalOffline" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="points-per-interval-offline"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="pointsPerIntervalOffline" onclick="commons.configEditable(this, '')" id="configPointsPerIntervalOffline"></abbr>
        <div class="input-group" style="display:none;" id="input_pointsPerIntervalOffline_group">
          <div class="input-group-addon" data-lang="points"></div>
          <input id="input_pointsPerIntervalOffline" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="points-per-message-interval"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="pointsMessageInterval" onclick="commons.configEditable(this, '')" id="configPointsMessageInterval"></abbr>
        <div class="input-group" style="display:none;" id="input_pointsMessageInterval_group">
          <div class="input-group-addon" data-lang="points"></div>
          <input id="input_pointsMessageInterval" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="points-per-message"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="pointsPerMessageInterval" onclick="commons.configEditable(this, '')" id="configPointsPerMessageInterval"></abbr>
        <div class="input-group" style="display:none;" id="input_pointsPerMessageInterval_group">
          <div class="input-group-addon" data-lang="points"></div>
          <input id="input_pointsPerMessageInterval" class="form-control input-sm" type="text" />
        </div>
      </div>
    </div>
  </div>

  <div role="tabpanel" class="tab-pane" id="songs">
    <div class="row settings">
      <div class="col">
        <strong data-lang="volume"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="songs_volume" onclick="commons.configEditable(this, '%')" id="configVolume"></abbr>
        <div class="input-group" style="display:none;" id="input_songs_volume_group">
          <div class="input-group-addon">%</div>
          <input id="input_songs_volume" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="max-duration"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="songs_duration" onclick="commons.configEditable(this, 'min')" id="configDuration"></abbr>
        <div class="input-group" style="display:none;" id="input_songs_duration_group">
          <div class="input-group-addon" data-lang="minutes"></div>
          <input id="input_songs_duration" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="shuffle"></strong>
      </div>
      <div class="col">
        <input id="shuffleToggle" type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="danger">
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="song-requests"></strong>
      </div>
      <div class="col">
        <input id="songrequestToggle" type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="danger">
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="playlist"></strong>
      </div>
      <div class="col">
        <input id="playlistToggle" type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="danger">
      </div>
    </div>
  </div>

  <div role="tabpanel" class="tab-pane" id="gambling">
    <div class="row settings">
      <div class="col">
        <strong data-lang="seppukuTimeout"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="seppukuTimeout" onclick="commons.configEditable(this, 's')" id="configSeppukuTimeout"></abbr>
        <div class="input-group" style="display:none;" id="input_seppukuTimeout_group">
          <div class="input-group-addon" data-lang="seconds"></div>
          <input id="input_seppukuTimeout" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="rouletteTimeout"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="rouletteTimeout" onclick="commons.configEditable(this, 's')" id="configRouletteTimeout"></abbr>
        <div class="input-group" style="display:none;" id="input_rouletteTimeout_group">
          <div class="input-group-addon" data-lang="seconds"></div>
          <input id="input_rouletteTimeout" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="fightmeTimeout"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="fightmeTimeout" onclick="commons.configEditable(this, 's')" id="configFightmeTimeout"></abbr>
        <div class="input-group" style="display:none;" id="input_fightmeTimeout_group">
          <div class="input-group-addon" data-lang="seconds"></div>
          <input id="input_fightmeTimeout" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="duelCooldown"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="duelCooldown" onclick="commons.configEditable(this, 's')" id="configDuelCooldown"></abbr>
        <div class="input-group" style="display:none;" id="input_duelCooldown_group">
          <div class="input-group-addon" data-lang="seconds"></div>
          <input id="input_duelCooldown" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="fightmeCooldown"></strong>
      </div>
      <div class="col">
        <abbr title="click to edit" data-config-id="fightmeCooldown" onclick="commons.configEditable(this, 's')" id="configFightmeCooldown"></abbr>
        <div class="input-group" style="display:none;" id="input_fightmeCooldown_group">
          <div class="input-group-addon" data-lang="seconds"></div>
          <input id="input_fightmeCooldown" class="form-control input-sm" type="text" />
        </div>
      </div>
      <div class="w-100"></div>

      <div class="col">
        <strong data-lang="gamblingCooldownBypass"></strong>
      </div>
      <div class="col">
        <input id="gamblingCooldownBypassToggle" type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="danger">
      </div>
    </div>
  </div>

  <div role="tabpanel" class="tab-pane" id="others">
    <div class="row settings">
      <div class="col">
        <strong data-lang="show-usernames-with-at"></strong>
      </div>
      <div class="col">
        <input id="atUsernameToggle" type="checkbox" data-toggle="toggle" data-onstyle="success" data-offstyle="danger">
      </div>
    </div>
  </div>
</div>

<script>
  if (!systems.points) $("#points-tab-link").css('display', 'none')
  if (!systems.songs) $("#songs-tab-link").css('display', 'none')
  if (!systems.cooldown) $(".systems-cooldown-only").css('display', 'none')

  socket.emit('getPointsConfiguration')
  socket.emit('getNoticeConfiguration')
  socket.emit('songs.sendConfiguration')
  socket.emit('getConfiguration')

  socket.once('configuration', function (data) {
    $("#configSeppukuTimeout").text(data.seppukuTimeout + 's')
    $("#configRouletteTimeout").text(data.rouletteTimeout + 's')
    $("#configFightmeTimeout").text(data.fightmeTimeout + 's')

    $("#configDuelCooldown").text(data.duelCooldown + 's')
    $("#configFightmeCooldown").text(data.fightmeCooldown + 's')

    $('#gamblingCooldownBypassToggle').off('change')
    $('#gamblingCooldownBypassToggle').bootstrapToggle(data.gamblingCooldownBypass ? 'on' : 'off')
    $('#gamblingCooldownBypassToggle').change(function () {
      if ($('#gamblingCooldownBypassToggle').data('init')) socket.emit('saveConfiguration', {
        'gamblingCooldownBypass': $(this).prop('checked')
      })
    })
    $('#gamblingCooldownBypassToggle').data('init', true)

    $('#atUsernameToggle').off('change')
    $('#atUsernameToggle').bootstrapToggle(data.atUsername ? 'on' : 'off')
    $('#atUsernameToggle').change(function () {
      if ($('#atUsernameToggle').data('init')) socket.emit('saveConfiguration', {
        'atUsername': $(this).prop('checked')
      })
    })
    $('#atUsernameToggle').data('init', true)

    /* whispers */
    $('#disableWhisperListener').off('change')
    $('#disableWhisperListener').bootstrapToggle(!data.disableWhisperListener ? 'on' : 'off')
    $('#disableWhisperListener').change(function () {
      if ($('#disableWhisperListener').data('init')) socket.emit('saveConfiguration', {
        'disableWhisperListener': !$(this).prop('checked')
      })
    })
    $('#disableWhisperListener').data('init', true)

    $('#disableSettingsWhispers').off('change')
    $('#disableSettingsWhispers').bootstrapToggle(!data.disableSettingsWhispers ? 'on' : 'off')
    $('#disableSettingsWhispers').change(function () {
      if ($('#disableSettingsWhispers').data('init')) socket.emit('saveConfiguration', {
        'disableSettingsWhispers': !$(this).prop('checked')
      })
    })
    $('#disableSettingsWhispers').data('init', true)

    $('#disablePermissionWhispers').off('change')
    $('#disablePermissionWhispers').bootstrapToggle(!data.disablePermissionWhispers ? 'on' : 'off')
    $('#disablePermissionWhispers').change(function () {
      if ($('#disablePermissionWhispers').data('init')) socket.emit('saveConfiguration', {
        'disablePermissionWhispers': !$(this).prop('checked')
      })
    })
    $('#disablePermissionWhispers').data('init', true)

    $('#disableCooldownWhispers').off('change')
    $('#disableCooldownWhispers').bootstrapToggle(!data.disableCooldownWhispers ? 'on' : 'off')
    $('#disableCooldownWhispers').change(function () {
      if ($('#disableCooldownWhispers').data('init')) socket.emit('saveConfiguration', {
        'disableCooldownWhispers': !$(this).prop('checked')
      })
    })
    $('#disableCooldownWhispers').data('init', true)
  })

  socket.off('pointsConfiguration')
  socket.on('pointsConfiguration', function (data) {
    $("#configPointsName").text(data.pointsName)
    $("#configPointsInterval").text(data.pointsInterval + 'min')
    $("#configPointsPerInterval").text(data.pointsPerInterval)
    $("#configPointsIntervalOffline").text(data.pointsIntervalOffline + 'min')
    $("#configPointsPerIntervalOffline").text(data.pointsPerIntervalOffline)
    $("#configPointsMessageInterval").text(data.pointsMessageInterval)
    $("#configPointsPerMessageInterval").text(data.pointsPerMessageInterval)
  })

  socket.off('noticesConfiguration')
  socket.on('noticesConfiguration', function (data) {
    $("#configNoticeInterval").text(data.interval + 'min')
    $("#configNoticeMsgReq").text(data.msgreq)
  })

  socket.off('songsConfiguration')
  socket.on('songsConfiguration', function (data) {
    $("#configVolume").text(data.volume + '%')
    $("#configDuration").text(data.duration + 'min')

    $('#shuffleToggle').bootstrapToggle(data.shuffle ? 'on' : 'off')
    $('#shuffleToggle').off('change')
    $('#shuffleToggle').change(function () {
      if ($('#shuffleToggle').data('init')) socket.emit('saveConfiguration', {
        'songs_shuffle': $(this).prop('checked')
      })
    })
    $('#shuffleToggle').data('init', true)

    $('#songrequestToggle').bootstrapToggle(data.songrequest ? 'on' : 'off')
    $('#songrequestToggle').off('change')
    $('#songrequestToggle').change(function () {
      if ($('#songrequestToggle').data('init')) socket.emit('saveConfiguration', {
        'songs_songrequest': $(this).prop('checked')
      })
    })
    $('#songrequestToggle').data('init', true)

    $('#playlistToggle').bootstrapToggle(data.playlist ? 'on' : 'off')
    $('#playlistToggle').off('change')
    $('#playlistToggle').change(function () {
      if ($('#playlistToggle').data('init')) socket.emit('saveConfiguration', {
        'songs_playlist': $(this).prop('checked')
      })
    })
    $('#playlistToggle').data('init', true)
  })

</script>
